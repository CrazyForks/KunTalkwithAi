<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Markdown 预览</title>
  <style>
    :root { color-scheme: light dark; }
    html, body { margin: 0; padding: 0; background: #111; }
    body { color: #eaeaea; font-family: -apple-system, system-ui, Segoe UI, Roboto, PingFang SC, Noto Sans SC, Microsoft YaHei, "Helvetica Neue", Arial, sans-serif; font-size: 16px; line-height: 1.5; }
    #content { white-space: pre-wrap; word-break: break-word; overflow-wrap: anywhere; width: 100%; line-height: 1.55; padding: 16px; }
    code { background: rgba(127,127,127,0.1); padding: 2px 4px; border-radius: 3px; }
    a { color: #7aa2f7; text-decoration: underline; }
    ul, ol { margin: .25em 0; padding-left: 1.25em; }
    blockquote { border-left: 3px solid rgba(127,127,127,.35); margin: .5em 0; padding: .25em .75em; opacity: .95; }
    h1,h2,h3,h4,h5,h6 { margin: .8em 0 .4em; font-weight: 700; }
    h1{ font-size: 1.6em; } h2{ font-size: 1.4em; } h3{ font-size: 1.25em; }
    h4{ font-size: 1.15em; } h5{ font-size: 1.05em; } h6{ font-size: 1em; opacity:.95; }
  </style>
</head>
<body>
  <div id="content"></div>
  <script>
    function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
    function simpleMarkdownToHtml(src){
      let s = escapeHtml(src);
      s = s.replace(/`([^`]+?)`/g,'<code>$1</code>');
      s = s.replace(/\[([^\]]+)\]\(([^)\s]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');
      // 支持 ASCII 与全角星号的加粗/斜体
      s = s.replace(/(?:\*{2}|＊{2})([\s\S]+?)(?:\*{2}|＊{2})/g,'<strong>$1</strong>');
      s = s.replace(/(^|[^*＊])(?:\*|＊)([^*＊\n]+)(?:\*|＊)(?![*＊])/g,'$1<em>$2</em>');
      const lines = s.split(/\n/);
      let out = '';
      let inUl = false, inOl = false, inQuote = false;
      function closeAll(){ if(inUl){ out += '</ul>'; inUl=false; } if(inOl){ out += '</ol>'; inOl=false; } if(inQuote){ out += '</blockquote>'; inQuote=false; } }
      for (let i=0;i<lines.length;i++){
        const line = lines[i];
        if (/^\s*(?:-{3,}|\*{3,}|_{3,})\s*$/.test(line)) { closeAll(); out += '<hr/>'; continue; }
        let hm = line.match(/^\s{0,3}(#{1,6})\s+(.+)$/);
        if (hm){ closeAll(); const level = hm[1].length; const text = hm[2]; out += `<h${level}>${text}</h${level}>`; continue; }
        let qm = line.match(/^\s{0,3}>\s?(.*)$/);
        if (qm){ if(!inQuote){ closeAll(); out += '<blockquote>'; inQuote = true; } out += (qm[1] || '') + (i<lines.length-1?'\n':''); continue; }
        else if (inQuote && line.trim() === '') { out += '\n'; continue; }
        else if (inQuote) { out += '</blockquote>'; inQuote = false; }
        let om = line.match(/^\s{0,3}(\d+)\.\s+(.+)$/);
        if (om){ if(!inOl){ closeAll(); out += '<ol>'; inOl = true; } out += `<li>${om[2]}</li>`; continue; }
        let um = line.match(/^\s{0,3}(?:[-*+])\s+(.+)$/);
        if (um){ if(!inUl){ closeAll(); out += '<ul>'; inUl = true; } out += `<li>${um[1]}</li>`; continue; }
        closeAll(); out += line + (i<lines.length-1?'\n':'');
      }
      closeAll();
      return out;
    }
    const demo = `# 一级标题

## 二级标题

- 列表 A
- 列表 B

1. 第一项
2. 第二项

> 这里是引用

内联代码: \`code\`，以及链接 [示例](https://example.com).

这是普通文本，AI输出的原始数学公式格式：$e^{i\\pi}+1=0$ 和 $$\\int_0^1 x^2\\,dx = \\frac{1}{3}$$`;
    const container = document.getElementById('content');
    container.innerHTML = simpleMarkdownToHtml(demo);
  </script>
</body>
</html>